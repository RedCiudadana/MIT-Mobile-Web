<?
$page->title($inst_name.' Campus Map: Details')
     ->navbar_image('title-map')
     ->not_scalable()
     ->add_stylesheet('styles/map-ip')
     ->breadcrumbs('Map Details')
     ->extra_onload("initialize()");
     #->extra_onload("loadImage(getMapURL(mapBaseURL),'mapimage');");

$page->content_begin();
?>

<?
# dirty but iphone specific markers
$marker_types = array();
$marker_types['Building'] = 'apartment';
$marker_types['Parking'] = 'parking';
$marker_types['Housing'] = 'home';
$marker_types['Athletic Facility'] = '';
$marker_types['Dining'] = 'restaurant';
$marker_types['Health Sciences Center'] = 'apartment';
$marker_types['PRT Station'] = 'train';
$marker_types['Computer Lab'] = 'computer';
$marker_types['Alumni Center'] = 'apartment';
$marker_types['Library'] = 'library';
$marker_types['Rec'] = 'pool';
$marker_types['Health'] = 'doctor';
$marker_types['Visitor'] = 'info';
$marker_types['Children'] = 'playground';
$marker_types['Student'] = 'clothes';
$marker_types['Track'] = '';
$marker_types['Tennis'] = 'tennis';
$marker_types['Football'] = 'rugby';
$marker_types['Baseball'] = '';
$marker_types['Soccer'] = 'soccer';
$marker_types['Basketball'] = 'basketball';
$marker_types['Newspaper'] = 'text';
$marker_types['Art'] = 'theater';
$marker_types['Green'] = 'flowers';
$marker_types['Hospital'] = 'hospital';
$marker_types['Admissions'] = 'university';
?>

	<a name="scrolldown"></a>		
	<div class="focal shaded">
    <? if ($data[0]['subtype'] != "") { $marker_type = $marker_types[$data[0]['subtype']]; } ?>
    <? else { $marker_type = $marker_types[$data[0]['type']]; }?>
		<h2><?=$data[0]['name']?> <img src="images/ip-markers/<?=$marker_types[$data[0]['type']]?>.png" height="20" width="17" alt="Marker" />  
			  <? if ($data[0]['wifi'] == 'Y') { ?><img src="images/ip-markers/wifi.png" height="20" width="17" alt="WiFi" /><? } ?></h2>
		<p class="address">
		   <?=$data[0]['physical_address']?>
		   <? if ($data[0]['phone'] != '') { ?><br /><?=$data[0]['phone']?><? } ?>
		   <? if ($data[0]['hours'] != '') { ?><br /><?=$data[0]['hours']?><? } ?>
		   <? if ($data[0]['website'] != '') { ?><br /><a href="http://<?=$data[0]['website']?>">website</a><? } ?>
		</p>
		<ul id="tabs">
			<li class="active"><a href="#scrolldown" onclick="showTab('maptab',this); hide('loadingimage')">Map</a></li>
		</ul>
		
		<div id="tabbodies">	
			<div class="tabbody" id="maptab">
			      <script src="http://maps.google.com/maps?file=api&amp;v=2&amp;sensor=true&amp;key=ABQIAAAAgl5MtLeiQwCMBX7FdoPP_BTfAZWzJoh_gYMfdqhKwTyraOPtpRSIZm3YBA6TbcecvlyiMX_gNejDzg" type="text/javascript"></script>	
        <script type="text/javascript">
				function initialize() {
					var map = new GMap2(document.getElementById("map_canvas"));
					map.setUIToDefault();
					map.setCenter(new GLatLng(<?=$data[0]['latitude']?>, <?=$data[0]['longitude']?>), 15);
				
					var point = new GLatLng(<?=$data[0]['latitude']?>, <?=$data[0]['longitude']?>);
					
					var baseIcon = new GIcon(G_DEFAULT_ICON);
					baseIcon.image = "images/ip-markers/<?=$marker_type?>.png";
					baseIcon.shadow = "images/ip-markers/shadow.png";
					baseIcon.iconSize = new GSize(32, 37);
					baseIcon.shadowSize = new GSize(51, 37);
					
					markerOptions = { icon:baseIcon };
					var marker = new GMarker(point, markerOptions);
					map.addOverlay(marker);
				}
				</script>
				<div id="map_canvas" style="width: 285px; height: 220px"></div>
			</div> <!-- id="maptab" -->

			<div class="clear"></div>
		</div>

	</div> <!-- class="focal shaded" -->
	
	  <ul class="secondary">
		<li>
			<a href="http://maps.google.com/maps?sll=<?=$data[0]['latitude']?>,<?=$data[0]['longitude']?>" class="external">Launch Google Maps</a>
		</li>
	  </ul>
<?
$page->content_end();


$script =<<<JS
	showTab('maptab');

	var objMap = document.getElementById('mapimage');
	if(objMap) {
		mapW = objMap.scrollWidth - 2;
		mapH = objMap.scrollHeight - 2;
	}

        checkIfMoved();
JS;

#$page->footer_script($script);
?>
