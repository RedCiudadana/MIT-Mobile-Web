<?
$page->title($inst_name.' Campus Map: Details')
     ->navbar_image('title-map')
     ->not_scalable()
     ->add_stylesheet('styles/map-ip')
     ->breadcrumbs('Map Details')
     ->extra_onload("loadImage(getMapURL(mapBaseURL),'mapimage');");

$page->content_begin();
?>

	<a name="scrolldown"></a>		
	<div class="focal shaded">

		<h2><?=$data[0]['name']?> <img src="images/marker-<?=marker_type($data[0]['type'])?>.png" height="24" width="14" alt="Marker" /></h2>
		<p class="address"><?=$data[0]['physical_address']?></p>
		<ul id="tabs">
			<li class="active"><a href="#scrolldown" onclick="showTab('maptab',this); hide('loadingimage')">Map</a></li>
		</ul>
		
		<div id="tabbodies">	
			<div class="tabbody" id="maptab">
				<script type="text/javascript">
				  var types = new Array();
				  types['Building'] = 'apartment';
				  types['Parking Lot'] = 'parking';
				
					var map = new GMap2(document.getElementById("map_canvas"));
					map.addControl(new GSmallMapControl());
					map.addControl(new GMapTypeControl());
					map.setCenter(new GLatLng(<?=$data[0]['latitude']?>, <?=$data[0]['longitude']?>), 15);
					
					point = new GLatLng(<?=$data[0]['latitude']?>, <?=$data[0]['longitude']?>);
					
					var baseIcon = new GIcon(G_DEFAULT_ICON);
					baseIcon.image = "images/ip-markers/"+types[$data[0]['type']]+'.png';
					baseIcon.shadow = "images/ip-markers/shadow.png";
					baseIcon.iconSize = new GSize(32, 37);
					baseIcon.shadowSize = new GSize(51, 37);
					
					markerOptions = { icon:baseIcon };
          var marker = new GMarker(point, markerOptions);
          map.addOverlay(createMarker(point, i));
				</script>
				<div id="map_canvas" style="width: 290px; height: 190px"><img id="mapimage" width="290" height="190" alt="" onload="hide('loadingimage')" /></div>
				<div id="mapzoom">
					<a href="#" onclick="recenter(); return false;" id="recenter" class="disabled"><img src="../ip/images/blank.png" width="40" height="34" alt="Recenter" /></a>
					<a href="detail-fullscreen.php" id="fullscreen"><img src="../ip/images/blank.png" width="40" height="34" alt="Full Screen" /></a>
				</div>
			</div> <!-- id="maptab" -->

			<div class="clear"></div>
		</div>

	</div> <!-- class="focal shaded" -->
	
        <? if(cleanStreet($data)) {?>
	   <ul class="secondary">
		<li>
			<a href="http://maps.google.com/maps?q=<?=cleanStreet($data)?>, <?=$data['city']?>" class="external">Google Map <span class="smallprint">(<?=cleanStreet($data)?>)</span></a>
		</li>
	  </ul>
	<? } ?>
<?
$page->content_end();


$script =<<<JS
	showTab('maptab');

	var objMap = document.getElementById('mapimage');
	if(objMap) {
		mapW = objMap.scrollWidth - 2;
		mapH = objMap.scrollHeight - 2;
	}

        checkIfMoved();
JS;

#$page->footer_script($script);
?>
